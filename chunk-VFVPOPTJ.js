import{Ba as F,Da as P,Eb as z,F as d,Fa as U,G as b,M as B,Ma as H,Na as Z,O,P as M,Q as p,Ra as A,U as V,Ub as u,Va as m,W as a,Wa as R,X as r,Y as _,Yb as c,aa as J,ba as L,ca as v,d as w,e as f,gc as G,ka as l,kc as D,la as x,m as C,ma as h,o as y,q as I,sa as q,u as j,v as T,vb as X,w as $,x as k}from"./chunk-DF4LRA7J.js";var ae=(()=>{class i extends z{pathId;ngOnInit(){this.pathId="url(#"+X()+")"}static \u0275fac=(()=>{let s;return function(t){return(s||(s=k(i)))(t||i)}})();static \u0275cmp=I({type:i,selectors:[["TimesCircleIcon"]],standalone:!0,features:[B,q],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M7 14C5.61553 14 4.26215 13.5895 3.11101 12.8203C1.95987 12.0511 1.06266 10.9579 0.532846 9.67879C0.00303296 8.3997 -0.13559 6.99224 0.134506 5.63437C0.404603 4.2765 1.07129 3.02922 2.05026 2.05026C3.02922 1.07129 4.2765 0.404603 5.63437 0.134506C6.99224 -0.13559 8.3997 0.00303296 9.67879 0.532846C10.9579 1.06266 12.0511 1.95987 12.8203 3.11101C13.5895 4.26215 14 5.61553 14 7C14 8.85652 13.2625 10.637 11.9497 11.9497C10.637 13.2625 8.85652 14 7 14ZM7 1.16667C5.84628 1.16667 4.71846 1.50879 3.75918 2.14976C2.79989 2.79074 2.05222 3.70178 1.61071 4.76768C1.16919 5.83358 1.05367 7.00647 1.27876 8.13803C1.50384 9.26958 2.05941 10.309 2.87521 11.1248C3.69102 11.9406 4.73042 12.4962 5.86198 12.7212C6.99353 12.9463 8.16642 12.8308 9.23232 12.3893C10.2982 11.9478 11.2093 11.2001 11.8502 10.2408C12.4912 9.28154 12.8333 8.15373 12.8333 7C12.8333 5.45291 12.2188 3.96918 11.1248 2.87521C10.0308 1.78125 8.5471 1.16667 7 1.16667ZM4.66662 9.91668C4.58998 9.91704 4.51404 9.90209 4.44325 9.87271C4.37246 9.84333 4.30826 9.8001 4.2544 9.74557C4.14516 9.6362 4.0838 9.48793 4.0838 9.33335C4.0838 9.17876 4.14516 9.0305 4.2544 8.92113L6.17553 7L4.25443 5.07891C4.15139 4.96832 4.09529 4.82207 4.09796 4.67094C4.10063 4.51982 4.16185 4.37563 4.26872 4.26876C4.3756 4.16188 4.51979 4.10066 4.67091 4.09799C4.82204 4.09532 4.96829 4.15142 5.07887 4.25446L6.99997 6.17556L8.92106 4.25446C9.03164 4.15142 9.1779 4.09532 9.32903 4.09799C9.48015 4.10066 9.62434 4.16188 9.73121 4.26876C9.83809 4.37563 9.89931 4.51982 9.90198 4.67094C9.90464 4.82207 9.84855 4.96832 9.74551 5.07891L7.82441 7L9.74554 8.92113C9.85478 9.0305 9.91614 9.17876 9.91614 9.33335C9.91614 9.48793 9.85478 9.6362 9.74554 9.74557C9.69168 9.8001 9.62748 9.84333 9.55669 9.87271C9.4859 9.90209 9.40996 9.91704 9.33332 9.91668C9.25668 9.91704 9.18073 9.90209 9.10995 9.87271C9.03916 9.84333 8.97495 9.8001 8.9211 9.74557L6.99997 7.82444L5.07884 9.74557C5.02499 9.8001 4.96078 9.84333 4.88999 9.87271C4.81921 9.90209 4.74326 9.91704 4.66662 9.91668Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(e,t){e&1&&($(),a(0,"svg",0)(1,"g"),_(2,"path",1),r(),a(3,"defs")(4,"clipPath",2),_(5,"rect",3),r()()()),e&2&&(V(t.getClassNames()),M("aria-label",t.ariaLabel)("aria-hidden",t.ariaHidden)("role",t.role),d(),M("clip-path",t.pathId),d(3),p("id",t.pathId))},encapsulation:2})}return i})();var K=(()=>{let n=class n{constructor(){this.selectedCustomerSource=new f(null),this.selectedCustomer$=this.selectedCustomerSource.asObservable(),this.filteredDataSource=new f([]),this.filteredData$=this.filteredDataSource.asObservable(),this.cxcItemsSource=new w,this.cxcItems$=this.cxcItemsSource.asObservable(),this.itemFactItems=new w,this.itemFact$=this.itemFactItems.asObservable(),this.prFactValueIntSubject=new f(null),this.prFactValueInt$=this.prFactValueIntSubject.asObservable()}setSelectedCustomer(e){this.selectedCustomerSource.next(e)}setFilteredData(e){this.filteredDataSource.next(e)}updateCxcItems(e){this.cxcItemsSource.next(e)}updateItemFact(e){this.itemFactItems.next(e)}setPrFactValueInt(e){this.prFactValueIntSubject.next(e)}};n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=C({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})();var Q=(()=>{let n=class n{getServices(){let t=JSON.parse(localStorage.getItem("userInfo")||"{}").pragma,o=new m({Pragma:t});return this.http.get(`${this.api}adm/services`,{headers:o})}getCustomers(){let t=JSON.parse(localStorage.getItem("userInfo")||"{}").pragma,o=new m({Pragma:t});return this.http.get(`${this.api}adm/customers/`,{headers:o})}getUsd(){return this.http.get(this.apiUsd)}getCorrelatives(){let t=JSON.parse(localStorage.getItem("userInfo")||"{}").pragma,o=new m({Pragma:t});return this.http.get(`${this.api}adm/correlatives`,{headers:o})}getCxc(){let t=JSON.parse(localStorage.getItem("userInfo")||"{}").pragma,o=new m({Pragma:t});return this.http.get(`${this.api}adm/accreceivables/?saldo>0`,{headers:o})}updateCxcSaldoToZero(){let e=localStorage.getItem("seleectedCxcId");if(!e)throw new Error("No se encontr\xF3 el n\xFAmero de CXC seleccionado en el local storage");let o=JSON.parse(localStorage.getItem("userInfo")||"{}").pragma,g=new m({"Content-Type":"application/json","x-api-key":"B5D31933-C996-476C-B116-EF212A41479A",Pragma:o}),S=[{id:parseInt(e),fromtran:0,monto:0,montomex:0,saldo:0,saldomex:0}];return console.log("Datos a enviar para actualizar el saldo de la CXC:",S),this.http.put(`${this.api}adm/accreceivables`,S,{headers:g})}getItems(){let t=JSON.parse(localStorage.getItem("userInfo")||"{}").pragma,o=new m({Pragma:t});return this.http.get(`${this.api}adm/invoiceitems`,{headers:o})}formInvoice(){return this.fb.group({codigo:new c(""),descripcion:new c(""),cantidad:new c(null),precio:new c(null),descuento:new c,impuesto:new c(null),totalItem:new c(null)})}formUserData(){return this.fb.group({cedula:new c("",[u.required]),cliente:new c("",[u.required]),direccion:new c("",[u.required]),telefono:new c("",[u.required]),email:new c("",[u.required]),direccionServicio:new c(""),descuento:new c("")})}constructor(e,t){this.http=e,this.fb=t,this.api=D.api,this.apiUsd=D.usdApi}};n.\u0275fac=function(t){return new(t||n)(y(R),y(G))},n.\u0275prov=C({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})();function te(i,n){if(i&1&&(a(0,"div")(1,"p")(2,"strong"),l(3,"Cliente:"),r(),l(4),r()()),i&2){let s=v();d(4),h(" ",s.selectedCustomer.descrip,"")}}function ie(i,n){if(i&1&&(a(0,"div")(1,"p")(2,"strong"),l(3,"C\xF3digo del Cliente:"),r(),l(4),r()()),i&2){let s=v();d(4),h(" ",s.filteredData[0]==null?null:s.filteredData[0].codclie,"")}}function ne(i,n){if(i&1){let s=J();a(0,"tr",4),L("click",function(){let t=j(s).$implicit,o=v();return T(o.onRowClick(t))}),a(1,"td",5),l(2),r(),a(3,"td",5),l(4),F(5,"date"),r(),a(6,"td",5),l(7),F(8,"date"),r(),a(9,"td"),l(10),r()()}if(i&2){let s=n.$implicit;d(2),x(s.numerod),d(2),x(P(5,4,s.fechai,"yyyy-MM-dd")),d(3),x(P(8,7,s.fechae,"yyyy-MM-dd")),d(3),h("Bs. ",s.montoneto,"")}}var ge=(()=>{let n=class n{constructor(e,t,o){this.sharedService=e,this.invoiceFormService=t,this.cdr=o,this.filteredData=[],this.totalCxc=0,this.selectedCustomer=null,this.selectedItems=[]}ngOnInit(){this.sharedService.selectedCustomer$.subscribe(e=>{this.selectedCustomer=e,console.log("Cliente seleccionado:",this.selectedCustomer)}),this.sharedService.filteredData$.subscribe(e=>{this.filteredData=e,console.log("Datos filtrados recibidos:",this.filteredData),this.calculateTotalCxc()})}calculateTotalCxc(){this.totalCxc=this.filteredData.length}onRowClick(e){let t=this.selectedItems.findIndex(o=>o.numerod===e.numerod);t===-1?this.selectedItems.push(e):this.selectedItems.splice(t,1),localStorage.setItem("cxc",JSON.stringify(this.selectedItems)),localStorage.setItem("selectedNumerod",e.numerod),localStorage.setItem("seleectedCxcId",e.id),this.sharedService.updateCxcItems(this.selectedItems),this.invoiceFormService.getItems().subscribe(o=>{let g=o.filter(N=>N.numerod===e.numerod&&N.tipofac==="H");console.log("Filtered items:",g);let W=[...JSON.parse(localStorage.getItem("itemFact"))||[],...g];localStorage.setItem("itemFact",JSON.stringify(W)),this.cdr.detectChanges(),window.location.href=window.location.href},o=>{console.error("Error fetching items:",o)})}};n.\u0275fac=function(t){return new(t||n)(b(K),b(Q),b(U))},n.\u0275cmp=I({type:n,selectors:[["app-collection-notices"]],decls:19,vars:4,consts:[[4,"ngIf"],[1,"items-table-container"],[1,"items-table"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"center"]],template:function(t,o){t&1&&(O(0,te,5,1,"div",0)(1,ie,5,1,"div",0),a(2,"h3"),l(3),r(),a(4,"div",1)(5,"div",2)(6,"table")(7,"thead")(8,"tr")(9,"th"),l(10,"Documento"),r(),a(11,"th"),l(12,"Fecha inicial"),r(),a(13,"th"),l(14,"Fecha final"),r(),a(15,"th"),l(16,"Monto"),r()()(),a(17,"tbody"),O(18,ne,11,10,"tr",3),r()()()()),t&2&&(p("ngIf",o.selectedCustomer),d(),p("ngIf",o.filteredData.length>0),d(2),h("Total de notificaciones: ",o.totalCxc," "),d(15),p("ngForOf",o.filteredData))},dependencies:[H,Z,A],styles:['@charset "UTF-8";.items-table-container[_ngcontent-%COMP%]{max-height:480px;overflow-y:auto;margin-top:0;display:block}.items-table[_ngcontent-%COMP%]{display:block}.items-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;display:table;margin-bottom:20px}.items-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .items-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:8px;text-align:right;vertical-align:middle;display:table-cell}.items-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#00f;color:#fff;font-weight:700;text-align:center;vertical-align:middle;display:table-cell}.items-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{display:table-header-group}.items-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]{display:table-row-group}.items-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:table-row;cursor:pointer}.items-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f9f9f9}.items-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.center[_ngcontent-%COMP%]{text-align:center!important}']});let i=n;return i})();export{ae as a,K as b,Q as c,ge as d};
